\begin{minipage}[t]{\sw}
\slidenumber
\LARGE
{\bf Language V5} (continued)\exx
To implement the recursive behavior of a \verb'letrec' as described above,
we create a new method \verb'addLetrecBindings'
in the \verb'LetDecls' class.
This new method is passed the environment
in which the \verb'letrec' expression appears,
and it returns a new environment
as described in the following steps.
\begin{enumerate}
\item [0.]
  Extend the environment actual parameter
  with an empty \verb'Bindings' object of sufficient size
  to hold all of the variable bindings.
  Call this new environment \verb'nenv'.
\item
  The two fields in the \verb'LetDecls' class are
  \verb'List<Token> varList' and \verb'List<Exp> expList'.
  Create iterators for these two lists
  and iterate through them together, in order.
  For each step in the iteration,
  get the next identifier \verb'var' from the \verb'varList',
  and save its \verb'String' representation in a variable \verb'str'.
  Also, get the next expression \verb'exp' from the \verb'expList',
  evaluate it in the environment \verb'nenv'
  obtained in Step 0, and save its value in a variable \verb'val'.
  Then create a \verb'new Binding(str, val)'
  and add it to the \verb'nenv' environment obtained in Step 0.
  This binding now becomes part of the local bindings in \verb'nenv',
  together with the other local bindings previously added
  during this iteration.
\item
  Once all of the new bindings have been added to \verb'nenv',
  return \verb'nenv' as the value of this method.
\end{enumerate}
\end{minipage}
\clearpage
