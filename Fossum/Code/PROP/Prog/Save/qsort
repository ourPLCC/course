define filter = proc(g, xs)
  if xs
  then
    let
      x = first(xs)
      ys = .filter(g, rest(xs))
    in
      if .g(x) then addFirst(x, ys) else ys
  else
    []
  
define append = proc(xs, ys)
  if xs
  then
    addFirst(first(xs), .append(rest(xs), ys))
  else
    ys 

.filter(proc(t) <?(t,5), [1,4,2,5,3,6,4,7])

.append([1,2,3], [4,5,6,7,8])

define qsort = proc(xs) %% a "real" list
  if xs 
  then
    let 
      x = first(xs)
      ys = rest(xs)
    in
%      let
%        lt = .qsort(.filter(proc(t) <?(t,x), ys))
%        ge = addFirst(x, .qsort(.filter(proc(t) >=?(t,x), ys)))
%      in
%        .append(lt, ge)
       .append(.qsort(.filter(proc(t) <?(t,x), ys)),
               addFirst(x, .qsort(.filter(proc(t) >=?(t,x), ys))))
          
  else
    []

.qsort([1,4,2,5,3,6,4,7])
%% this uses the contents of the 'list' file

define rands = []
set rands = addFirst(18,rands)
set rands = addFirst(25,rands)
set rands = addFirst(25,rands)
set rands = addFirst(18,rands)
set rands = addFirst(22,rands)
set rands = addFirst(32,rands)
set rands = addFirst(1,rands)
set rands = addFirst(32,rands)
set rands = addFirst(19,rands)
set rands = addFirst(0,rands)
set rands = addFirst(34,rands)
set rands = addFirst(19,rands)
set rands = addFirst(30,rands)
set rands = addFirst(14,rands)
set rands = addFirst(38,rands)
set rands = addFirst(0,rands)
set rands = addFirst(12,rands)
set rands = addFirst(13,rands)
set rands = addFirst(10,rands)
set rands = addFirst(42,rands)
set rands = addFirst(31,rands)
set rands = addFirst(47,rands)
set rands = addFirst(23,rands)
set rands = addFirst(5,rands)
set rands = addFirst(1,rands)
set rands = addFirst(8,rands)
set rands = addFirst(36,rands)
set rands = addFirst(33,rands)
set rands = addFirst(13,rands)
set rands = addFirst(41,rands)
set rands = addFirst(47,rands)
set rands = addFirst(6,rands)
set rands = addFirst(19,rands)
set rands = addFirst(19,rands)
set rands = addFirst(37,rands)
set rands = addFirst(42,rands)
set rands = addFirst(39,rands)
set rands = addFirst(39,rands)
set rands = addFirst(17,rands)
set rands = addFirst(41,rands)
set rands = addFirst(44,rands)
set rands = addFirst(39,rands)
set rands = addFirst(1,rands)
set rands = addFirst(27,rands)
set rands = addFirst(35,rands)
set rands = addFirst(43,rands)
set rands = addFirst(2,rands)
set rands = addFirst(15,rands)
set rands = addFirst(36,rands)
set rands = addFirst(26,rands)
set rands = addFirst(3,rands)
set rands = addFirst(49,rands)
set rands = addFirst(2,rands)
set rands = addFirst(1,rands)
set rands = addFirst(13,rands)
set rands = addFirst(11,rands)
set rands = addFirst(15,rands)
set rands = addFirst(38,rands)
set rands = addFirst(35,rands)
set rands = addFirst(47,rands)
set rands = addFirst(26,rands)
set rands = addFirst(42,rands)
set rands = addFirst(31,rands)
set rands = addFirst(8,rands)
set rands = addFirst(20,rands)
set rands = addFirst(27,rands)
set rands = addFirst(6,rands)
set rands = addFirst(25,rands)
set rands = addFirst(2,rands)
set rands = addFirst(22,rands)
set rands = addFirst(14,rands)
set rands = addFirst(14,rands)
set rands = addFirst(48,rands)
set rands = addFirst(39,rands)
set rands = addFirst(0,rands)
set rands = addFirst(46,rands)
set rands = addFirst(32,rands)
set rands = addFirst(6,rands)
set rands = addFirst(32,rands)
set rands = addFirst(41,rands)
set rands = addFirst(11,rands)
set rands = addFirst(9,rands)
set rands = addFirst(25,rands)
set rands = addFirst(23,rands)
set rands = addFirst(18,rands)
set rands = addFirst(12,rands)
set rands = addFirst(15,rands)
set rands = addFirst(15,rands)
set rands = addFirst(22,rands)
set rands = addFirst(37,rands)
set rands = addFirst(25,rands)
set rands = addFirst(43,rands)
set rands = addFirst(41,rands)
set rands = addFirst(1,rands)
set rands = addFirst(9,rands)
set rands = addFirst(3,rands)
set rands = addFirst(1,rands)
set rands = addFirst(23,rands)
set rands = addFirst(33,rands)
set rands = addFirst(31,rands)
set rands = addFirst(30,rands)
set rands = addFirst(36,rands)
set rands = addFirst(38,rands)
set rands = addFirst(35,rands)
set rands = addFirst(25,rands)
set rands = addFirst(26,rands)
set rands = addFirst(39,rands)
set rands = addFirst(2,rands)
set rands = addFirst(36,rands)
set rands = addFirst(37,rands)
set rands = addFirst(48,rands)
set rands = addFirst(1,rands)
set rands = addFirst(12,rands)
set rands = addFirst(15,rands)
set rands = addFirst(34,rands)
set rands = addFirst(5,rands)
set rands = addFirst(0,rands)
set rands = addFirst(36,rands)
set rands = addFirst(33,rands)
set rands = addFirst(16,rands)
set rands = addFirst(10,rands)
set rands = addFirst(33,rands)
set rands = addFirst(49,rands)
set rands = addFirst(45,rands)
set rands = addFirst(49,rands)
set rands = addFirst(12,rands)
set rands = addFirst(14,rands)
set rands = addFirst(22,rands)
set rands = addFirst(2,rands)
set rands = addFirst(24,rands)
set rands = addFirst(48,rands)
set rands = addFirst(41,rands)
set rands = addFirst(0,rands)
set rands = addFirst(5,rands)
set rands = addFirst(35,rands)
set rands = addFirst(47,rands)
set rands = addFirst(35,rands)
set rands = addFirst(7,rands)
set rands = addFirst(27,rands)
set rands = addFirst(37,rands)
set rands = addFirst(20,rands)
set rands = addFirst(47,rands)
set rands = addFirst(42,rands)
set rands = addFirst(35,rands)
set rands = addFirst(29,rands)
set rands = addFirst(39,rands)
set rands = addFirst(6,rands)
set rands = addFirst(47,rands)
set rands = addFirst(8,rands)
set rands = addFirst(8,rands)
set rands = addFirst(8,rands)
set rands = addFirst(36,rands)
set rands = addFirst(1,rands)
set rands = addFirst(15,rands)
set rands = addFirst(30,rands)
set rands = addFirst(29,rands)
set rands = addFirst(45,rands)
set rands = addFirst(44,rands)
set rands = addFirst(24,rands)
set rands = addFirst(6,rands)
set rands = addFirst(25,rands)
set rands = addFirst(4,rands)
set rands = addFirst(40,rands)
set rands = addFirst(4,rands)
set rands = addFirst(1,rands)
set rands = addFirst(34,rands)
set rands = addFirst(25,rands)
set rands = addFirst(43,rands)
set rands = addFirst(28,rands)
set rands = addFirst(38,rands)
set rands = addFirst(44,rands)
set rands = addFirst(42,rands)
set rands = addFirst(12,rands)
set rands = addFirst(24,rands)
set rands = addFirst(47,rands)
set rands = addFirst(18,rands)
set rands = addFirst(40,rands)
set rands = addFirst(42,rands)
set rands = addFirst(24,rands)
set rands = addFirst(42,rands)
set rands = addFirst(12,rands)
set rands = addFirst(8,rands)
set rands = addFirst(1,rands)
set rands = addFirst(32,rands)
set rands = addFirst(43,rands)
set rands = addFirst(39,rands)
set rands = addFirst(15,rands)
set rands = addFirst(33,rands)
set rands = addFirst(18,rands)
set rands = addFirst(15,rands)
set rands = addFirst(49,rands)
set rands = addFirst(44,rands)
set rands = addFirst(15,rands)
set rands = addFirst(43,rands)
set rands = addFirst(22,rands)
set rands = addFirst(0,rands)
set rands = addFirst(43,rands)
set rands = addFirst(22,rands)
set rands = addFirst(11,rands)
set rands = addFirst(44,rands)

define double = proc(x) .append(x,x)

define len = proc(xs) if xs then add1(.len(rest(xs))) else 0

set rands = .double(.double(.double(.double(.double(rands)))))

.len(rands)

.qsort(rands)
